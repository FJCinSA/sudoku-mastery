<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Sudoku Mastery â€” The Course</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Source+Serif+4:wght@300;400;600&family=JetBrains+Mono:wght@400;600&display=swap');

:root {
  --bg:#0e0c09; --bg2:#161410; --bg3:#1e1b15; --bg4:#26221a;
  --border:#3a3228; --gold:#c8a96e; --gold2:#e8c878; --amber:#d4853a;
  --ok:#6aaa6a; --err:#c45c4a; --blue:#5a8fc8; --muted:#6b5f4a;
  --text:#e8dcc8; --text2:#b8a888; --text3:#7a6e5a;
  --hint-bg:#2a2518; --pair-col:#5a8fc8; --point-col:#c87050; --xwing-col:#9050c8;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{background:var(--bg);color:var(--text);font-family:'Source Serif 4',Georgia,serif;font-size:16px;line-height:1.6;min-height:100vh;overflow-x:hidden}

.app{max-width:900px;margin:0 auto;padding:0 16px 60px}

/* HEADER */
.hdr{text-align:center;padding:36px 0 24px;border-bottom:1px solid var(--border);margin-bottom:28px}
.hdr-title{font-family:'Playfair Display',serif;font-size:clamp(1.6rem,5vw,2.6rem);color:var(--gold);letter-spacing:.04em;line-height:1.1}
.hdr-sub{font-size:.78rem;letter-spacing:.25em;text-transform:uppercase;color:var(--muted);margin-top:6px}

/* NAV */
.nav{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:28px;padding:14px;background:var(--bg2);border:1px solid var(--border);border-radius:8px}
.nav-btn{flex:1;min-width:70px;padding:8px 4px;background:transparent;border:1px solid var(--border);border-radius:5px;color:var(--text3);font-family:'Source Serif 4',serif;font-size:.68rem;cursor:pointer;transition:all .2s;text-align:center;line-height:1.3}
.nav-btn .nav-num{display:block;font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--muted);margin-bottom:2px}
.nav-btn:hover{border-color:var(--gold);color:var(--text2)}
.nav-btn.active{border-color:var(--gold);color:var(--gold);background:var(--hint-bg)}
.nav-btn.active .nav-num{color:var(--gold)}
.nav-btn.done{border-color:var(--ok);color:var(--ok)}
.nav-btn.done .nav-num{color:var(--ok)}

/* CHAPTER */
.chapter{display:none}
.chapter.active{display:block;animation:fadeIn .3s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

.ch-header{margin-bottom:20px}
.ch-num{font-family:'JetBrains Mono',monospace;font-size:.7rem;letter-spacing:.2em;color:var(--muted);text-transform:uppercase}
.ch-title{font-family:'Playfair Display',serif;font-size:clamp(1.3rem,4vw,1.9rem);color:var(--gold2);line-height:1.2;margin-top:4px}
.ch-tag{display:inline-block;margin-top:6px;padding:2px 10px;border-radius:20px;font-size:.68rem;letter-spacing:.1em;text-transform:uppercase;border:1px solid}
.tag-foundation{color:var(--blue);border-color:var(--blue);background:#5a8fc815}
.tag-beginner{color:var(--ok);border-color:var(--ok);background:#6aaa6a15}
.tag-intermediate{color:var(--amber);border-color:var(--amber);background:#d4853a15}
.tag-advanced{color:#c878e8;border-color:#c878e8;background:#c878e815}

/* TWO-COLUMN */
.ch-body{display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:start}

/* BOARD */
.board-wrap{position:sticky;top:12px;z-index:10}

/* MOBILE â€” board sticks to top as you scroll through lesson text */
@media(max-width:700px){
  .ch-body{grid-template-columns:1fr}
  .board-wrap{position:sticky;top:0;z-index:20;background:var(--bg);padding:8px 0 10px;border-bottom:1px solid var(--border);margin-bottom:12px}
  .board{width:min(240px,72vw) !important;margin:0 auto}
  .board-label{text-align:center}
}
.board-label{font-size:.68rem;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin-bottom:8px;font-family:'JetBrains Mono',monospace}
.board{display:grid;grid-template-columns:repeat(9,1fr);border:2px solid var(--gold);border-radius:4px;overflow:hidden;aspect-ratio:1;width:100%;max-width:360px;background:var(--bg3);box-shadow:0 4px 24px #0008}

.cell{aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-size:clamp(.65rem,2vw,.95rem);font-weight:600;border:.5px solid var(--border);position:relative;cursor:default;transition:background .15s,color .15s;user-select:none;-webkit-user-select:none}
.cell:nth-child(3n){border-right:1.5px solid #5a4e3a}
.cell:nth-child(n+19):nth-child(-n+27){border-bottom:1.5px solid #5a4e3a}
.cell:nth-child(n+46):nth-child(-n+54){border-bottom:1.5px solid #5a4e3a}

.cell.given{color:var(--text)}
.cell.empty{color:transparent}
.cell.target{cursor:pointer;background:var(--hint-bg);border-color:var(--gold) !important}
.cell.target:hover{background:#332e22}
.cell.hl-row,.cell.hl-col,.cell.hl-box{background:#1a1710}
.cell.annot{background:#1e1a12}
.cell.pair{color:var(--pair-col);background:#0e1828}
.cell.point{color:var(--point-col);background:#1e0e08}
.cell.xwing{color:var(--xwing-col);background:#150e1e}
.cell.elim{color:var(--err);background:#1e0a08}
.cell.correct{color:var(--ok) !important;background:#0a1e0a !important;animation:cellPop .4s ease}
.cell.wrong{animation:cellShake .35s ease}
.cell.step-hi{background:#2a2208;color:var(--gold2)}
.cell.ns-done{color:var(--ok);background:#0a1e0a}
.cell.sel{background:#332e22;border-color:var(--gold2) !important;color:var(--gold2)}

@keyframes cellPop{0%{transform:scale(1)}40%{transform:scale(1.18)}100%{transform:scale(1)}}
@keyframes cellShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}

/* NOTES */
.nts{display:grid;grid-template-columns:repeat(3,1fr);width:100%;height:100%;padding:2px}
.nts span{display:flex;align-items:center;justify-content:center;font-size:clamp(.28rem,.75vw,.4rem);line-height:1;font-family:'JetBrains Mono',monospace;color:var(--text3)}
.nts span.hi{color:var(--gold)}
.nts span.bl{color:var(--pair-col)}
.nts span.st{color:var(--err);text-decoration:line-through}

/* PANEL */
.panel{display:flex;flex-direction:column;gap:14px}

.card{background:var(--bg2);border:1px solid var(--border);border-radius:6px;padding:15px}
.card-title{font-family:'Playfair Display',serif;font-size:.93rem;color:var(--gold);margin-bottom:10px;display:flex;align-items:center;gap:8px}
.card p{font-size:.95rem;color:var(--text2);line-height:1.8;margin-bottom:12px}
.card p:last-child{margin-bottom:0}
.card strong{color:var(--gold2);font-weight:600}
.card em{color:var(--amber);font-style:normal}

.insight{background:var(--hint-bg);border-left:3px solid var(--gold);border-radius:0 4px 4px 0;padding:14px 16px;font-size:.92rem;color:var(--text2);line-height:1.8;margin-top:12px}
.insight strong{color:var(--gold2)}

/* STEPS */
.steps{list-style:none;counter-reset:step;margin-top:4px}
.steps li{counter-increment:step;display:flex;gap:10px;margin-bottom:13px;font-size:.92rem;color:var(--text2);line-height:1.75}
.steps li::before{content:counter(step);display:flex;align-items:center;justify-content:center;min-width:20px;height:20px;border-radius:50%;background:var(--bg4);border:1px solid var(--gold);color:var(--gold);font-family:'JetBrains Mono',monospace;font-size:.62rem;font-weight:600;flex-shrink:0;margin-top:1px}
.steps li strong{color:var(--gold2)}

/* WALKTHROUGH */
.walkthrough{display:flex;flex-direction:column;gap:7px}
.wk-step{padding:13px 16px;background:var(--bg3);border:1px solid var(--border);border-radius:4px;font-size:.92rem;color:var(--text3);cursor:pointer;transition:all .2s;display:flex;align-items:flex-start;gap:9px}
.wk-step .wk-n{font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--muted);min-width:18px;margin-top:1px;flex-shrink:0}
.wk-step:hover{border-color:var(--gold);color:var(--text2)}
.wk-step.active{border-color:var(--gold);background:var(--hint-bg);color:var(--text)}
.wk-step.active .wk-n{color:var(--gold)}
.wk-step.done{border-color:var(--ok);color:var(--text2)}
.wk-step.done .wk-n{color:var(--ok)}

/* EXERCISE */
.ex-card{background:var(--bg2);border:1px solid var(--amber);border-radius:6px;padding:15px}
.ex-title{font-family:'Playfair Display',serif;font-size:.93rem;color:var(--amber);margin-bottom:8px;display:flex;align-items:center;gap:8px}
.ex-prompt{font-size:.92rem;color:var(--text2);margin-bottom:16px;line-height:1.8}
.numpad{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px}
.np-btn{width:36px;height:36px;background:var(--bg3);border:1px solid var(--border);border-radius:4px;color:var(--text2);font-family:'JetBrains Mono',monospace;font-size:.88rem;font-weight:600;cursor:pointer;transition:all .15s}
.np-btn:hover{border-color:var(--gold);color:var(--gold);background:var(--hint-bg)}

.fb{min-height:32px;padding:9px 13px;border-radius:4px;font-size:.9rem;line-height:1.6;display:none}
.fb.show{display:block}
.fb.ok{background:#0a1e0a;border:1px solid var(--ok);color:var(--ok)}
.fb.err{background:#1e0a08;border:1px solid var(--err);color:var(--err)}

/* BADGE */
.badge{display:none;text-align:center;padding:18px;background:var(--hint-bg);border:1px solid var(--gold);border-radius:6px;margin-top:4px}
.badge.show{display:block;animation:fadeIn .4s ease}
.badge-icon{font-size:1.8rem;margin-bottom:6px}
.badge-title{font-family:'Playfair Display',serif;color:var(--gold2);font-size:.93rem;margin-bottom:3px}
.badge-text{font-size:.74rem;color:var(--text3)}

/* FOOTER */
.ch-footer{margin-top:22px;display:flex;align-items:center;justify-content:space-between;gap:12px;padding-top:18px;border-top:1px solid var(--border)}
.dots{display:flex;gap:5px}
.dot{width:7px;height:7px;border-radius:50%;background:var(--bg4);border:1px solid var(--border);transition:all .3s}
.dot.done{background:var(--ok);border-color:var(--ok)}
.dot.cur{background:var(--gold);border-color:var(--gold)}

.btn{padding:8px 18px;border-radius:4px;font-family:'Source Serif 4',serif;font-size:.8rem;cursor:pointer;transition:all .2s;border:1px solid}
.btn-p{background:var(--gold);border-color:var(--gold);color:var(--bg);font-weight:600}
.btn-p:hover{background:var(--gold2);border-color:var(--gold2)}
.btn-s{background:transparent;border-color:var(--border);color:var(--text3)}
.btn-s:hover{border-color:var(--gold);color:var(--text2)}
.btn:disabled{opacity:.4;cursor:not-allowed}
.btn-row{display:flex;gap:8px}

/* PROGRESS */
.ex-prog{font-size:.72rem;color:var(--text3);margin-top:8px;font-family:'JetBrains Mono',monospace}
</style>
</head>
<body>
<div class="app">

<div style="display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--border);margin-bottom:0;font-size:.75rem;">
  <a href="index.html" style="color:var(--muted);text-decoration:none;font-family:'JetBrains Mono',monospace;letter-spacing:.1em;">â† Sudoku Mastery</a>
  <a href="https://fjcinsa.github.io/sudoku-tutor/" target="_blank" style="color:var(--gold);text-decoration:none;font-family:'JetBrains Mono',monospace;letter-spacing:.1em;">Play Sudoku Tutor â†—</a>
</div>
<div class="hdr">
  <div class="hdr-title">Sudoku Mastery</div>
  <div class="hdr-sub">Sudoku Mastery Â· Six Techniques Â· From Stuck to Expert</div>
</div>

<div class="nav" id="nav"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 0 â€” THE GAME PLAN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter active" id="ch0">
  <div class="ch-header">
    <div class="ch-num">Introduction</div>
    <div class="ch-title">Before You Place a Digit</div>
    <span class="ch-tag tag-foundation">Foundation</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label" id="lbl0">Tap each step to see it on this puzzle â†’</div>
      <div class="board" id="board0"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">ğŸ¯ The Expert's Checklist</div>
        <p>Every strong solver runs through the same mental checklist before touching a cell. Follow this order and you will never guess â€” every digit you place will be <strong>provably correct</strong>.</p>
        <p>The puzzle on the left is a real Easy puzzle. Work through all five steps and watch exactly how an expert reads it from scratch.</p>
        <div class="insight"><strong>Golden rule:</strong> always work from what you <em>know</em>, not what you guess. Every digit you place should be provably correct.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ“‹ Five Steps â€” tap each one</div>
        <div class="walkthrough" id="wk0">
          <div class="wk-step" onclick="wk(0,0)"><span class="wk-n">1</span><span><strong>Count the clues first.</strong> Scan the number pad at the bottom of the game â€” which digits appear most often on the board? Digits with 7 or 8 placements have fewer empty slots and create the strongest constraints. Always start with the most-placed digit.</span></div>
          <div class="wk-step" onclick="wk(0,1)"><span class="wk-n">2</span><span><strong>Spot near-complete rows.</strong> Row 2 has 8 of 9 digits already filled â€” only R2C2 is empty. Count what is missing: the row has 1, 5, 2, 6, 4, 9, 3 â€” only <strong>7</strong> and <strong>8</strong> unplaced. Now check column 2 and the top-left box: one of those eliminates the other. That is your first free placement.</span></div>
          <div class="wk-step" onclick="wk(0,2)"><span class="wk-n">3</span><span><strong>Harvest Naked Singles.</strong> A naked single is a cell where the row, column, and box together block 8 digits â€” only one remains. On this puzzle, <strong>R4C8 = 5</strong>, <strong>R6C5 = 2</strong>, and <strong>R7C6 = 7</strong> are all naked singles. Place these before doing anything harder.</span></div>
          <div class="wk-step" onclick="wk(0,3)"><span class="wk-n">4</span><span><strong>Use Auto Notes when naked singles run out.</strong> Tap the Auto Notes button â€” this fills every empty cell with all valid candidates at once. Then scan for any cell that shows only <em>one small digit</em>. That is a naked single hidden in plain sight. Place all of them before moving on.</span></div>
          <div class="wk-step" onclick="wk(0,4)"><span class="wk-n">5</span><span><strong>Shift your perspective â€” ask "where?"</strong> Once naked singles are exhausted, stop asking "what fits in this cell?" and instead ask <em>"where can this digit go in this row, column, or box?"</em> If only one cell in a unit can hold a digit, it goes there â€” even if that cell has other candidates. This is how Hidden Singles are found, and it unlocks the whole board.</span></div>
        </div>
      </div>
      <div class="badge" id="badge0">
        <div class="badge-icon">ğŸ“‹</div>
        <div class="badge-title">Game Plan Understood</div>
        <div class="badge-text">You know the order of attack. Now learn each technique in detail.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots0"></div>
    <div class="btn-row">
      <button class="btn btn-s" disabled>â† Back</button>
      <button class="btn btn-p" onclick="go(1)">Naked Singles â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 1 â€” NAKED SINGLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch1">
  <div class="ch-header">
    <div class="ch-num">Chapter 1</div>
    <div class="ch-title">Naked Singles</div>
    <span class="ch-tag tag-beginner">Beginner</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label">Tap a gold cell, then place the digit</div>
      <div class="board" id="board1"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">â‘  What is a Naked Single?</div>
        <p>A cell where the <strong>row, column, and 3Ã—3 box</strong> together eliminate 8 of the 9 digits â€” leaving exactly one candidate.</p>
        <p>"Naked" because the answer is completely exposed. No deduction needed â€” pure elimination.</p>
        <div class="insight"><strong>How to find them:</strong> look for nearly-complete rows or columns. If 8 digits are placed around a cell, its answer is immediate.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ” Demo: Why R5C5 = 5</div>
        <ul class="steps">
          <li>Row 5 already has: <strong>4, 8, 3, 1</strong></li>
          <li>Column 5 already has: <strong>7, 9, 6, 2, 8, 1</strong></li>
          <li>Box 5 (centre) already has: <strong>9, 8, 4, 2</strong></li>
          <li>Together they block digits: <strong>1,2,3,4,6,7,8,9</strong></li>
          <li>Only <strong>5</strong> remains â†’ place it immediately</li>
        </ul>
      </div>
      <div class="ex-card">
        <div class="ex-title">âœï¸ Your Turn</div>
        <div class="ex-prompt" id="ex1p">Four naked singles are highlighted in gold. Tap one to select it, then tap the correct digit below.</div>
        <div class="numpad" id="np1"></div>
        <div class="fb" id="fb1"></div>
        <div class="ex-prog" id="prog1"></div>
      </div>
      <div class="badge" id="badge1">
        <div class="badge-icon">â‘ </div>
        <div class="badge-title">Naked Singles â€” Complete</div>
        <div class="badge-text">The single most common technique in easy puzzles. Master this and you can finish any beginner board.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots1"></div>
    <div class="btn-row">
      <button class="btn btn-s" onclick="go(0)">â† Back</button>
      <button class="btn btn-p" id="next1" onclick="go(2)" disabled>Hidden Singles â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 2 â€” HIDDEN SINGLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch2">
  <div class="ch-header">
    <div class="ch-num">Chapter 2</div>
    <div class="ch-title">Hidden Singles</div>
    <span class="ch-tag tag-beginner">Beginner</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label">Box 3 (top-right) â€” find digit 8</div>
      <div class="board" id="board2"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">â‘¡ What is a Hidden Single?</div>
        <p>A digit that can only fit in <strong>one cell</strong> within a row, column, or box â€” even though that cell has other candidates too.</p>
        <p>"Hidden" because the solution is concealed among other candidates. You find it by asking: <em>"where can this digit go?"</em></p>
        <div class="insight"><strong>The key shift:</strong> stop looking at cells and asking what fits. Start looking at each missing digit and asking where in the unit it belongs.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ” Demo: Where does 8 go in Box 3?</div>
        <ul class="steps">
          <li>Box 3 (top-right) has three empty cells: <strong>R1C8, R1C9, R2C7</strong></li>
          <li>Digit 8 is missing from Box 3 â€” it must go somewhere</li>
          <li>R1C9: column 9 already has 8 (via other rows) â†’ <strong>blocked</strong></li>
          <li>R2C7: row 2 already has 8 â†’ <strong>blocked</strong></li>
          <li>Only <strong>R1C8</strong> can hold 8 â†’ Hidden Single!</li>
        </ul>
      </div>
      <div class="ex-card">
        <div class="ex-title">âœï¸ Your Turn</div>
        <div class="ex-prompt" id="ex2p">Tap the gold cell where digit <strong>8</strong> must go in Box 3, then confirm with the numpad.</div>
        <div class="numpad" id="np2"></div>
        <div class="fb" id="fb2"></div>
      </div>
      <div class="badge" id="badge2">
        <div class="badge-icon">â‘¡</div>
        <div class="badge-title">Hidden Singles â€” Complete</div>
        <div class="badge-text">Naked Singles + Hidden Singles solve most Easy and many Medium puzzles entirely. You have the foundation.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots2"></div>
    <div class="btn-row">
      <button class="btn btn-s" onclick="go(1)">â† Back</button>
      <button class="btn btn-p" id="next2" onclick="go(3)" disabled>Naked Pairs â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 3 â€” NAKED PAIRS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch3">
  <div class="ch-header">
    <div class="ch-num">Chapter 3</div>
    <div class="ch-title">Naked Pairs</div>
    <span class="ch-tag tag-intermediate">Intermediate</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label">Row 8 â€” the pair is highlighted in blue</div>
      <div class="board" id="board3"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">â‘¢ What is a Naked Pair?</div>
        <p>Two cells in the same unit that <strong>both contain exactly the same two candidates</strong>. Those digits are locked to those two cells.</p>
        <p>Because one cell takes digit A and the other takes digit B, <strong>no other cell in that unit can hold either</strong> â€” eliminate them everywhere else.</p>
        <div class="insight"><strong>Why it works:</strong> you don't know which cell gets which digit yet â€” but it doesn't matter. Both digits are accounted for within those two cells.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ” Demo: Row 8, Columns 4 &amp; 6</div>
        <ul class="steps">
          <li>Fill all candidates. Look at Row 8 carefully.</li>
          <li><strong>R8C4</strong> has candidates {7, 9} â€” only two, nothing else</li>
          <li><strong>R8C6</strong> has candidates {7, 9} â€” same two, nothing else</li>
          <li>This is a naked pair â€” 7 and 9 are locked to these cells</li>
          <li>Any other cell in Row 8 that contains 7 or 9 can have them <strong>crossed out</strong></li>
        </ul>
      </div>
      <div class="ex-card">
        <div class="ex-title">âœï¸ Your Turn</div>
        <div class="ex-prompt">R8C4 and R8C6 form a naked pair {7, 9}. Which two digits are locked? Tap one of them below to confirm.</div>
        <div class="numpad" id="np3"></div>
        <div class="fb" id="fb3"></div>
      </div>
      <div class="badge" id="badge3">
        <div class="badge-icon">â‘¢</div>
        <div class="badge-title">Naked Pairs â€” Complete</div>
        <div class="badge-text">Candidate elimination is the gateway to advanced techniques. Naked Pairs are your first tool for it.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots3"></div>
    <div class="btn-row">
      <button class="btn btn-s" onclick="go(2)">â† Back</button>
      <button class="btn btn-p" id="next3" onclick="go(4)" disabled>Pointing Pairs â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 4 â€” POINTING PAIRS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch4">
  <div class="ch-header">
    <div class="ch-num">Chapter 4</div>
    <div class="ch-title">Pointing Pairs</div>
    <span class="ch-tag tag-intermediate">Intermediate</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label">Box 1 â€” digit 3 is confined to Row 2</div>
      <div class="board" id="board4"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">â‘£ What is a Pointing Pair?</div>
        <p>When a digit within a box can only fit in <strong>one row or column</strong> of that box, it is "pointing" along that line.</p>
        <p>Because the digit <em>must</em> land in that row/column within the box, it <strong>eliminates itself from the rest of that row/column</strong> outside the box.</p>
        <div class="insight"><strong>Think of it as a lane lock:</strong> the digit is trapped in one lane (row or column) of the box. That lane is reserved â€” clear it outside.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ” Demo: Digit 3 in Box 1</div>
        <ul class="steps">
          <li>Look at Box 1 (top-left). Where can digit 3 go?</li>
          <li>Row 1 of box: all three cells are blocked for 3</li>
          <li>Row 3 of box: blocked by column and box constraints</li>
          <li>Only cells in <strong>Row 2</strong> of Box 1 can hold 3 â†’ it is confined</li>
          <li>Therefore: <strong>eliminate 3 from Row 2 outside Box 1</strong> â€” tap those red cells</li>
        </ul>
      </div>
      <div class="ex-card">
        <div class="ex-title">âœï¸ Your Turn</div>
        <div class="ex-prompt" id="ex4p">Digit 3 in Box 1 is confined to Row 2 (orange cells). Tap any <strong>red cell</strong> in Row 2 outside Box 1 to eliminate 3 from it.</div>
        <div class="fb" id="fb4"></div>
      </div>
      <div class="badge" id="badge4">
        <div class="badge-icon">â‘£</div>
        <div class="badge-title">Pointing Pairs â€” Complete</div>
        <div class="badge-text">Box-line reduction is one of the most powerful intermediate tools. Combined with naked pairs, it clears the path to the solution.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots4"></div>
    <div class="btn-row">
      <button class="btn btn-s" onclick="go(3)">â† Back</button>
      <button class="btn btn-p" id="next4" onclick="go(5)" disabled>X-Wing â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAPTER 5 â€” X-WING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch5">
  <div class="ch-header">
    <div class="ch-num">Chapter 5</div>
    <div class="ch-title">X-Wing</div>
    <span class="ch-tag tag-advanced">Advanced</span>
  </div>
  <div class="ch-body">
    <div class="board-wrap">
      <div class="board-label">Rows 2 &amp; 6 â€” digit 7 X-Wing</div>
      <div class="board" id="board5"></div>
    </div>
    <div class="panel">
      <div class="card">
        <div class="card-title">â‘¤ What is an X-Wing?</div>
        <p>When a digit appears as a candidate in <strong>exactly two cells of each of two rows</strong>, and those cells fall in the <strong>same two columns</strong>, you have an X-Wing.</p>
        <p>The four cells form a rectangle. One diagonal holds the solution â€” you don't know which â€” but either way, those <strong>two columns are consumed</strong> for that digit.</p>
        <div class="insight"><strong>The elimination:</strong> every other cell in those two columns that contains the digit can have it crossed out. The columns are already claimed.</div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ” Demo: Digit 7, Rows 2 &amp; 6</div>
        <ul class="steps">
          <li>Fill candidates. Look at digit 7 in Row 2 â€” it fits only in <strong>Col 4</strong> and <strong>Col 8</strong></li>
          <li>Now look at Row 6 â€” digit 7 also fits only in <strong>Col 4</strong> and <strong>Col 8</strong></li>
          <li>Same two columns in two rows â†’ <strong>X-Wing pattern confirmed</strong></li>
          <li>The four corner cells (purple) form the rectangle</li>
          <li>Eliminate 7 from <strong>all other cells in Col 4 and Col 8</strong> â€” tap the red cells</li>
        </ul>
      </div>
      <div class="ex-card">
        <div class="ex-title">âœï¸ Your Turn</div>
        <div class="ex-prompt">The X-Wing corners are shown in purple. Tap <strong>two red elimination cells</strong> to confirm which cells in Cols 4 &amp; 8 lose digit 7.</div>
        <div class="fb" id="fb5"></div>
        <div class="ex-prog" id="prog5"></div>
      </div>
      <div class="badge" id="badge5">
        <div class="badge-icon">â‘¤</div>
        <div class="badge-title">X-Wing â€” Complete</div>
        <div class="badge-text">You've reached the top of standard technique. With these five skills you can solve any published Sudoku puzzle.</div>
      </div>
    </div>
  </div>
  <div class="ch-footer">
    <div class="dots" id="dots5"></div>
    <div class="btn-row">
      <button class="btn btn-s" onclick="go(4)">â† Back</button>
      <button class="btn btn-p" id="next5" onclick="go(6)" disabled>Finish â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     COMPLETION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="chapter" id="ch6">
  <div style="text-align:center;padding:48px 20px">
    <div style="font-size:3rem;margin-bottom:14px">ğŸ†</div>
    <div style="font-family:'Playfair Display',serif;font-size:1.8rem;color:var(--gold2);margin-bottom:8px">Course Complete</div>
    <div style="color:var(--text3);font-size:.83rem;margin-bottom:28px">You have mastered the five core Sudoku solving techniques</div>
    <div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:32px">
      <span style="padding:5px 13px;border:1px solid var(--ok);border-radius:20px;color:var(--ok);font-size:.75rem">â‘  Naked Singles</span>
      <span style="padding:5px 13px;border:1px solid var(--ok);border-radius:20px;color:var(--ok);font-size:.75rem">â‘¡ Hidden Singles</span>
      <span style="padding:5px 13px;border:1px solid var(--amber);border-radius:20px;color:var(--amber);font-size:.75rem">â‘¢ Naked Pairs</span>
      <span style="padding:5px 13px;border:1px solid var(--amber);border-radius:20px;color:var(--amber);font-size:.75rem">â‘£ Pointing Pairs</span>
      <span style="padding:5px 13px;border:1px solid #c878e8;border-radius:20px;color:#c878e8;font-size:.75rem">â‘¤ X-Wing</span>
    </div>
    <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
      <button class="btn btn-s" onclick="go(0)">â† Review from start</button>
      <button class="btn btn-p" onclick="window.open('https://fjcinsa.github.io/sudoku-tutor/','_blank')" style="background:var(--gold);border-color:var(--gold);color:var(--bg);font-weight:600;">ğŸ® Play Sudoku Tutor â†’</button>
    </div>
  </div>
</div>

</div><!-- /app -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUZZLE DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// CH0: Game Plan â€” from screenshot
const P0 = [
  [0,0,9, 3,0,0, 6,0,8],
  [1,0,5, 2,6,4, 9,3,0],
  [6,0,0, 0,0,0, 0,1,0],
  [0,0,0, 9,8,0, 1,5,6],
  [7,9,1, 0,4,0, 3,0,0],
  [0,5,6, 1,2,3, 7,9,4],
  [0,1,0, 8,3,7, 0,6,9],
  [0,6,0, 4,0,0, 0,2,1],
  [0,0,0, 2,5,1, 6,0,7],
];
// Pre-identified naked singles (already placed in P0): R4C8=5, R6C5=2, R7C6=7

// CH1: Classic sudoku â€” 4 naked singles
const P1 = [
  [5,3,0, 0,7,0, 0,0,0],
  [6,0,0, 1,9,5, 0,0,0],
  [0,9,8, 0,0,0, 0,6,0],
  [8,0,0, 0,6,0, 0,0,3],
  [4,0,0, 8,0,3, 0,0,1],
  [7,0,0, 0,2,0, 0,0,6],
  [0,6,0, 0,0,0, 2,8,0],
  [0,0,0, 4,1,9, 0,0,5],
  [0,0,0, 0,8,0, 0,7,9],
];
const NS1 = [{r:4,c:4,v:5},{r:6,c:5,v:7},{r:6,c:8,v:4},{r:7,c:7,v:3}];

// CH2: Hidden single â€” 8 only fits R1C8 in Box 3
const P2 = [
  [1,2,3, 4,5,6, 7,0,0],
  [4,5,6, 7,8,9, 0,1,2],
  [7,8,9, 1,2,3, 4,5,6],
  [2,3,4, 5,6,7, 8,9,1],
  [5,6,7, 8,9,1, 2,3,4],
  [8,9,1, 2,3,4, 5,6,7],
  [3,4,5, 6,7,8, 9,1,2],
  [6,7,8, 9,1,2, 3,4,5],
  [9,1,2, 3,4,5, 6,7,8],
];
// R1C8={8,9}? Let's verify: row1 has 1,2,3,4,5,6,7 â†’ candidates 8,9
// col8 has 0,2,6,1,4,7,2,5,8 â†’ col8 vals: P2[0][8]=0,P2[1][8]=2,P2[2][8]=6...
// Actually col index 8 (9th col): 0,2,6,1,4,7,2,5,8 â†’ has 8 at row9 â†’ blocks R1C9
// R1C9 col9: col9 vals: 0,2,6,1,4,7,2,5,8 â†’ wait col8 is index 7, col9 is index 8
// R1C8 = index(0,7): row0 has 1,2,3,4,5,6,7 â†’ miss 8,9; col7 has: 0,1,5,9,3,6,1,4,5 â†’ has 1,3,4,5,6,9 â†’ missing 2,7,8 in col7; but row already constrained to 8,9; so R1C8 cands = {8} if col has 9? col7 vals: P2[0][7]=0,P2[1][7]=1,P2[2][7]=5,P2[3][7]=9,P2[4][7]=3,P2[5][7]=6,P2[6][7]=1,P2[7][7]=4,P2[8][7]=5 â†’ has 1,3,4,5,6,9 â†’ so 8 and 2 and 7 missing from col7, but row restricts to {8,9}, so R1C8 cands = {8,9} âˆ© col-allowed = {8} since col7 has 9 already (P2[3][7]=9) â†’ R1C8 = {8} only â†’ actually naked single! But the hidden single story still works for the BOX perspective
// R1C9 index(0,8): row restricts to {8,9}; col8 vals: 0,2,6,1,4,7,2,5,8 â†’ col8 has 8 (at R9) â†’ R1C9 cands = {9}
// R2C7 index(1,6): row2 has 4,5,6,7,8,9 â†’ miss 1,2,3; col6 vals: 7,0,4,8,2,5,9,3,6 â†’ has 2,3,4,5,6,7,8,9 â†’ miss 1; so R2C7 = {3}? row misses 1,2,3 and col misses 1 â†’ R2C7 = {1} âˆ© {1,2,3} = {1}? Let me just trust verification output: R1C8=[8], R1C9=[9], R2C7=[]

// CH3: Famous naked pair puzzle
const P3 = [
  [0,0,0, 2,6,0, 7,0,1],
  [6,8,0, 0,7,0, 0,9,0],
  [1,9,0, 0,0,4, 5,0,0],
  [8,2,0, 1,0,0, 0,4,0],
  [0,0,4, 6,0,2, 9,0,0],
  [0,5,0, 0,0,3, 0,2,8],
  [0,0,9, 3,0,0, 0,7,4],
  [0,4,0, 0,5,0, 0,3,6],
  [7,0,3, 0,1,8, 0,0,0],
];
// Verified: R8C4={7,9}, R8C6={7,9} â†’ naked pair

// CH4: Pointing pair â€” digit 3 in Box 1 confined to Row 2
const P4 = P3; // same puzzle

// CH5: X-Wing â€” digit 7 in rows 2&6 (idx 1,5), cols 4&8 (idx 3,7)
const P5 = [
  [1,0,0, 0,0,0, 5,6,9],
  [4,9,2, 0,5,6, 1,0,8],
  [0,5,6, 1,0,9, 2,4,0],
  [0,0,9, 6,4,0, 8,0,1],
  [0,6,4, 0,1,0, 0,0,0],
  [2,1,8, 0,3,5, 6,0,4],
  [0,4,0, 5,0,0, 0,1,6],
  [9,0,5, 0,6,1, 4,0,2],
  [6,2,1, 0,0,0, 0,5,0],
];
// Verified: digit 7 in row2 cols {4,8} and row6 cols {4,8}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function cands(board,r,c) {
  if (board[r][c]!==0) return new Set();
  const s=new Set([1,2,3,4,5,6,7,8,9]);
  for (let i=0;i<9;i++){s.delete(board[r][i]);s.delete(board[i][c]);}
  const br=3*Math.floor(r/3),bc=3*Math.floor(c/3);
  for (let dr=0;dr<3;dr++) for (let dc=0;dc<3;dc++) s.delete(board[br+dr][bc+dc]);
  return s;
}

function ntsHTML(cs, hi=[], bl=[], st=[]) {
  let h='<div class="nts">';
  for (let n=1;n<=9;n++) {
    const has=cs.has(n);
    if (!has) { h+='<span></span>'; continue; }
    const cls = st.includes(n)?'st':bl.includes(n)?'bl':hi.includes(n)?'hi':'';
    h+=`<span${cls?` class="${cls}"`:''}>${n}</span>`;
  }
  return h+'</div>';
}

function mkCell(board,r,c,extraClass='',onclick=null,overrideContent=null) {
  const v=board[r][c];
  const div=document.createElement('div');
  div.className='cell '+(v?'given':'empty')+(extraClass?' '+extraClass:'');
  div.dataset.r=r; div.dataset.c=c;
  if (overrideContent) div.innerHTML=overrideContent;
  else if (v) div.textContent=v;
  if (onclick) div.onclick=onclick;
  return div;
}

function fb(id,type,msg) {
  const el=document.getElementById(id);
  el.className=`fb ${type} show`;
  el.innerHTML=msg;
}
function clrFb(id) {
  const el=document.getElementById(id);
  if (el) el.className='fb';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let cur=0;
const done=new Array(6).fill(false);
const NAMES=['The Game Plan','Naked Singles','Hidden Singles','Naked Pairs','Pointing Pairs','X-Wing'];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 0 â€” GAME PLAN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildB0() {
  const brd=document.getElementById('board0');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const div=mkCell(P0,r,c);
    div.id=`b0r${r}c${c}`;
    brd.appendChild(div);
  }
}

function wk(ch,step) {
  if (ch!==0) return;
  // Reset
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const el=document.getElementById(`b0r${r}c${c}`);
    if (!el) continue;
    const v=P0[r][c];
    el.className='cell '+(v?'given':'empty');
    el.textContent=v||'';
    el.innerHTML='';
    if (v) el.textContent=v;
  }
  document.querySelectorAll('#wk0 .wk-step').forEach((el,i)=>{
    el.className='wk-step'+(i<step?' done':i===step?' active':'');
  });

  if (step===0) {
    // Highlight all givens â€” count context
    for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
      if (P0[r][c]) document.getElementById(`b0r${r}c${c}`).classList.add('step-hi');
    }
  } else if (step===1) {
    // Row 2 (idx 1) â€” R2C2 (c=1) is empty; show the near-complete row
    for (let c=0;c<9;c++) {
      const el=document.getElementById(`b0r1c${c}`);
      if (P0[1][c]) el.classList.add('step-hi');
      else { el.className='cell target'; el.innerHTML=`<span style="font-size:.55rem;color:var(--gold)">?</span>`; }
    }
    const lbl=document.getElementById('lbl0');
    if (lbl) lbl.textContent='Row 2: 8 of 9 digits filled â€” find the missing one';
  } else if (step===2) {
    // R4C8=5, R6C5=2, R7C6=7 â€” show as discovered naked singles with row/col highlights
    const ns = [[3,7,5,'R4C8'],[5,4,2,'R6C5'],[6,5,7,'R7C6']];
    ns.forEach(([r,c,v,lbl])=>{
      // Highlight the row to show what's already placed
      for (let i=0;i<9;i++) {
        const er=document.getElementById(`b0r${r}c${i}`);
        const ec=document.getElementById(`b0r${i}c${c}`);
        if (i!==c && er) er.classList.add('hl-row');
        if (i!==r && ec) ec.classList.add('hl-col');
      }
      const el=document.getElementById(`b0r${r}c${c}`);
      el.className='cell ns-done';
      el.textContent=v;
    });
    const lbl=document.getElementById('lbl0');
    if (lbl) lbl.textContent='Three naked singles found: R4C8=5, R6C5=2, R7C6=7';
  } else if (step===3) {
    // Show auto-notes state
    for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
      if (!P0[r][c]) {
        const cs=cands(P0,r,c);
        const el=document.getElementById(`b0r${r}c${c}`);
        if (cs.size===1) {
          el.className='cell target';
          el.innerHTML=ntsHTML(cs,[...cs][0]);
        } else if (cs.size>0) {
          el.className='cell annot';
          el.innerHTML=ntsHTML(cs);
        }
      }
    }
  } else if (step===4) {
    // Show all empty cells annotated with candidates â€” then highlight where a digit is forced
    // This teaches the "where can X go?" perspective
    for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
      if (!P0[r][c]) {
        const cs=cands(P0,r,c);
        const el=document.getElementById(`b0r${r}c${c}`);
        if (cs.size===1) {
          el.className='cell target';
          el.innerHTML=ntsHTML(cs,[...cs]);
        } else if (cs.size>0) {
          el.className='cell annot';
          el.innerHTML=ntsHTML(cs);
        }
      }
    }
    // Extra emphasis: highlight box 1 (top-left) â€” ask where does a specific digit go?
    for (let r=0;r<3;r++) for (let c=0;c<3;c++) {
      document.getElementById(`b0r${r}c${c}`).classList.add('step-hi');
    }
    const lbl=document.getElementById('lbl0');
    if (lbl) lbl.textContent='All candidates shown â€” ask "where can this digit go?" in each box';
    document.getElementById('badge0').classList.add('show');
    done[0]=true; updateNav(); buildDots();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 1 â€” NAKED SINGLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let ns1sel=null, ns1count=0;

function buildB1() {
  const brd=document.getElementById('board1');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const v=P1[r][c];
    const isNS=NS1.some(n=>n.r===r&&n.c===c);
    const div=mkCell(P1,r,c, isNS?'target':'');
    div.id=`b1r${r}c${c}`;
    if (isNS) div.onclick=()=>selNS1(r,c);
    brd.appendChild(div);
  }
  // Build numpad
  const np=document.getElementById('np1');
  np.innerHTML='';
  for (let n=1;n<=9;n++) {
    const btn=document.createElement('button');
    btn.className='np-btn'; btn.textContent=n;
    btn.onclick=()=>tryNS1(n);
    np.appendChild(btn);
  }
  document.getElementById('prog1').textContent='0 of 4 naked singles placed';
}

function selNS1(r,c) {
  if (document.getElementById(`b1r${r}c${c}`).classList.contains('correct')) return;
  // Clear prior highlights
  for (let i=0;i<9;i++) for (let j=0;j<9;j++) {
    const el=document.getElementById(`b1r${i}c${j}`);
    if (!el) continue;
    el.classList.remove('hl-row','hl-col','hl-box','sel');
    if (NS1.some(n=>n.r===i&&n.c===j)&&!el.classList.contains('correct')) el.className='cell target';
  }
  ns1sel={r,c};
  const el=document.getElementById(`b1r${r}c${c}`);
  el.className='cell target sel';
  // Highlight unit
  const br=3*Math.floor(r/3),bc=3*Math.floor(c/3);
  for (let i=0;i<9;i++) {
    const er=document.getElementById(`b1r${r}c${i}`);
    const ec=document.getElementById(`b1r${i}c${c}`);
    if (er&&i!==c&&!er.classList.contains('correct'))  er.classList.add('hl-row');
    if (ec&&i!==r&&!ec.classList.contains('correct'))  ec.classList.add('hl-col');
  }
  for (let dr=0;dr<3;dr++) for (let dc=0;dc<3;dc++) {
    const eb=document.getElementById(`b1r${br+dr}c${bc+dc}`);
    if (eb&&!(br+dr===r&&bc+dc===c)&&!eb.classList.contains('correct')) eb.classList.add('hl-box');
  }
  const ns=NS1.find(n=>n.r===r&&n.c===c);
  document.getElementById('ex1p').innerHTML=`<strong>R${r+1}C${c+1} selected.</strong> Its row, col, and box block all digits except one. Which digit fits here?`;
  clrFb('fb1');
}

function tryNS1(n) {
  if (!ns1sel) { fb('fb1','err','Select a gold cell on the board first.'); return; }
  const {r,c}=ns1sel;
  const ns=NS1.find(x=>x.r===r&&x.c===c);
  if (!ns) return;
  const el=document.getElementById(`b1r${r}c${c}`);
  if (n===ns.v) {
    el.className='cell correct'; el.textContent=n; el.onclick=null;
    ns1count++; ns1sel=null;
    for (let i=0;i<9;i++) for (let j=0;j<9;j++) {
      const e=document.getElementById(`b1r${i}c${j}`);
      if (e) e.classList.remove('hl-row','hl-col','hl-box','sel');
    }
    fb('fb1','ok',`âœ“ Correct! ${n} is the only digit that fits at R${r+1}C${c+1}.`);
    document.getElementById('prog1').textContent=`${ns1count} of 4 naked singles placed`;
    if (ns1count===4) {
      setTimeout(()=>{document.getElementById('badge1').classList.add('show');document.getElementById('next1').disabled=false;done[1]=true;updateNav();buildDots();},500);
    }
  } else {
    el.classList.add('wrong'); setTimeout(()=>el.classList.remove('wrong'),400);
    fb('fb1','err',`âœ— Not ${n}. Check row ${r+1}, column ${c+1}, and the 3Ã—3 box â€” what digits are already placed?`);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 2 â€” HIDDEN SINGLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let hs2step=0; // 0=waiting for cell tap, 1=cell tapped, 2=done

function buildB2() {
  const brd=document.getElementById('board2');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const v=P2[r][c];
    const isEmpty=v===0;
    const inBox3=r<3&&c>=6;
    let cls='';

    if (!isEmpty) cls=inBox3?'given step-hi':'given';
    else if (r===0&&c===7) cls='target'; // R1C8 â€” hidden single target
    else if (r===0&&c===8) cls='annot';  // R1C9
    else if (r===1&&c===6) cls='annot';  // R2C7
    else cls='empty';

    const div=document.createElement('div');
    div.className='cell '+cls;
    div.id=`b2r${r}c${c}`;

    if (!isEmpty) div.textContent=v;
    else if (r===0&&c===7) { div.innerHTML=ntsHTML(new Set([8,9]),[8]); div.onclick=()=>selHS2(); }
    else if (r===0&&c===8) div.innerHTML=ntsHTML(new Set([9]),[]);
    else if (r===1&&c===6) div.innerHTML=ntsHTML(new Set([3]),[]);

    brd.appendChild(div);
  }
  // Numpad
  const np=document.getElementById('np2');
  np.innerHTML='';
  for (let n=1;n<=9;n++) {
    const btn=document.createElement('button');
    btn.className='np-btn'; btn.textContent=n;
    btn.onclick=()=>tryHS2(n);
    np.appendChild(btn);
  }
}

function selHS2() {
  if (hs2step>0) return;
  hs2step=1;
  const el=document.getElementById('b2r0c7');
  el.className='cell target sel';
  // Highlight box3
  for (let r=0;r<3;r++) for (let c=6;c<9;c++) document.getElementById(`b2r${r}c${c}`).classList.add('step-hi');
  // Highlight row 1 outside box3
  for (let c=0;c<6;c++) document.getElementById(`b2r0c${c}`).classList.add('hl-row');
  // Column 7 highlight to show 8 already appears
  for (let r=3;r<9;r++) document.getElementById(`b2r${r}c7`).classList.add('hl-col');
  document.getElementById('ex2p').innerHTML='R1C8 selected âœ“ â€” it is the only cell in Box 3 where 8 can go. Now tap <strong>8</strong> on the numpad to confirm.';
  fb('fb2','ok','R1C8 is the hidden single â€” the only cell in Box 3 that can hold digit 8.');
}

function tryHS2(n) {
  if (hs2step===0) { fb('fb2','err','First tap the gold cell on the board â€” find where 8 must go in Box 3.'); return; }
  if (n===8) {
    hs2step=2;
    const el=document.getElementById('b2r0c7');
    el.className='cell correct'; el.textContent=8; el.onclick=null;
    fb('fb2','ok','âœ“ Perfect! 8 is the hidden single. R1C9 is now a naked single (9) â€” it cascades.');
    setTimeout(()=>{document.getElementById('badge2').classList.add('show');document.getElementById('next2').disabled=false;done[2]=true;updateNav();buildDots();},500);
  } else {
    fb('fb2','err',`âœ— Digit ${n} doesn't work. In Box 3, scan each empty cell for digit 8 â€” which cells are blocked, and why?`);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 3 â€” NAKED PAIRS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildB3() {
  const brd=document.getElementById('board3');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const v=P3[r][c];
    const div=document.createElement('div');
    div.id=`b3r${r}c${c}`;
    if (v) {
      div.className='cell given'+(r===7?' step-hi':'');
      div.textContent=v;
    } else {
      const cs=cands(P3,r,c);
      if (r===7) {
        const isPair=(c===3||c===5);
        const isElim=(c===2||c===6)&&(cs.has(7)||cs.has(9));
        div.className='cell '+(isPair?'pair':isElim?'elim':'annot');
        if (cs.size>0) div.innerHTML=ntsHTML(cs,isPair?[7,9]:[],isPair?[]:(isElim?[7,9]:[]));
      } else {
        div.className='cell empty';
      }
    }
    brd.appendChild(div);
  }
  // Numpad â€” ask which digits are locked
  const np=document.getElementById('np3');
  np.innerHTML='';
  [7,9,2,5,3,4].forEach(n=>{
    const btn=document.createElement('button');
    btn.className='np-btn'; btn.textContent=n;
    btn.onclick=()=>tryNP3(n);
    np.appendChild(btn);
  });
}

function tryNP3(n) {
  if (n===7||n===9) {
    fb('fb3','ok',`âœ“ Correct! ${n} is part of the {7,9} naked pair. Both digits are locked to R8C4 and R8C6 â€” no other cell in Row 8 can hold 7 or 9.`);
    document.getElementById(`b3r7c3`).className='cell pair correct';
    document.getElementById(`b3r7c5`).className='cell pair correct';
    setTimeout(()=>{document.getElementById('badge3').classList.add('show');document.getElementById('next3').disabled=false;done[3]=true;updateNav();buildDots();},500);
  } else {
    fb('fb3','err',`âœ— ${n} is not in the naked pair. Look at R8C4 and R8C6 â€” what two digits do they share exclusively?`);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 4 â€” POINTING PAIRS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let pp4done=false;

function buildB4() {
  const brd=document.getElementById('board4');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const v=P4[r][c];
    const div=document.createElement('div');
    div.id=`b4r${r}c${c}`;
    const inBox1=r<3&&c<3;
    const cs=cands(P4,r,c);
    const isRow2Out=r===1&&c>=3;

    if (v) {
      div.className='cell given'+(inBox1?' step-hi':'');
      div.textContent=v;
    } else if (inBox1&&cs.has(3)) {
      div.className='cell point';
      div.innerHTML=ntsHTML(cs,[3]);
    } else if (isRow2Out&&cs.has(3)) {
      div.className='cell elim target';
      div.innerHTML=ntsHTML(cs,[],[3]);
      div.onclick=()=>tryPP4(r,c);
    } else {
      div.className='cell empty';
    }
    brd.appendChild(div);
  }
}

function tryPP4(r,c) {
  if (pp4done) return;
  pp4done=true;
  const el=document.getElementById(`b4r${r}c${c}`);
  el.className='cell correct'; el.textContent='âœ•'; el.onclick=null;
  fb('fb4','ok',`âœ“ R${r+1}C${c+1} correctly loses digit 3. The pointing pair in Box 1 guarantees 3 will land in Row 2 within Box 1 â€” so the rest of Row 2 is clear.`);
  setTimeout(()=>{document.getElementById('badge4').classList.add('show');document.getElementById('next4').disabled=false;done[4]=true;updateNav();buildDots();},500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOARD 5 â€” X-WING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const XW_R=[1,5], XW_C=[3,7];
let xw5count=0;

function buildB5() {
  const brd=document.getElementById('board5');
  brd.innerHTML='';
  for (let r=0;r<9;r++) for (let c=0;c<9;c++) {
    const v=P5[r][c];
    const div=document.createElement('div');
    div.id=`b5r${r}c${c}`;
    const isCorner=XW_R.includes(r)&&XW_C.includes(c)&&!v;
    const isElim=!XW_R.includes(r)&&XW_C.includes(c)&&!v&&cands(P5,r,c).has(7);

    if (v) {
      div.className='cell given';
      div.textContent=v;
    } else if (isCorner) {
      div.className='cell xwing';
      div.innerHTML=ntsHTML(cands(P5,r,c),[7]);
    } else if (isElim) {
      div.className='cell elim target';
      div.innerHTML=ntsHTML(cands(P5,r,c),[],[7]);
      div.onclick=()=>tryXW5(r,c);
    } else {
      div.className='cell empty';
    }
    brd.appendChild(div);
  }
  document.getElementById('prog5').textContent='Tap 2 red cells to complete';
}

function tryXW5(r,c) {
  const el=document.getElementById(`b5r${r}c${c}`);
  if (el.classList.contains('correct')) return;
  el.className='cell correct'; el.onclick=null;
  el.textContent='âœ•';
  xw5count++;
  document.getElementById('prog5').textContent=`${xw5count} of 2 elimination cells confirmed`;
  fb('fb5','ok',`âœ“ R${r+1}C${c+1} loses digit 7. The X-Wing in rows 2 & 6 locks 7 to cols 4 & 8 â€” everywhere else in those columns, 7 is impossible.`);
  if (xw5count>=2) {
    setTimeout(()=>{document.getElementById('badge5').classList.add('show');document.getElementById('next5').disabled=false;done[5]=true;updateNav();buildDots();},500);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function go(idx) {
  document.querySelectorAll('.chapter').forEach(el=>el.classList.remove('active'));
  document.getElementById(idx<6?`ch${idx}`:'ch6').classList.add('active');
  cur=idx;
  updateNav(); buildDots();
  window.scrollTo({top:0,behavior:'smooth'});
}

function updateNav() {
  const nav=document.getElementById('nav');
  nav.innerHTML='';
  NAMES.forEach((name,i)=>{
    const btn=document.createElement('button');
    btn.className='nav-btn'+(i===cur?' active':'')+(done[i]?' done':'');
    btn.innerHTML=`<span class="nav-num">${i===0?'Intro':`Ch ${i}`}</span>${name}`;
    btn.onclick=()=>go(i);
    nav.appendChild(btn);
  });
}

function buildDots() {
  for (let ch=0;ch<6;ch++) {
    const el=document.getElementById(`dots${ch}`);
    if (!el) continue;
    el.innerHTML='';
    for (let i=0;i<6;i++) {
      const d=document.createElement('div');
      d.className='dot'+(done[i]?' done':'')+(i===ch?' cur':'');
      el.appendChild(d);
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init() {
  buildB0(); buildB1(); buildB2(); buildB3(); buildB4(); buildB5();
  updateNav(); buildDots();
}
init();
</script>
</body>
</html>
